{
  "name": "Azure_Audit_LinuxVM_PasswdFile_Permission",
  "policy_id": "/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b",
  "display_name": "Azure Audit LinuxVM PasswdFile Permission",
  "description": "This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that do not have the passwd file permissions set to 0644",
  "category": "service",
  "status": "active",
  "content": "{\n \"policyType\": \"BuiltIn\",\n \"mode\": \"All\",\n \"metadata\": {\n \"policy_id\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\n \"policy_description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that do not have the passwd file permissions set to 0644\",\n \"classification\": \"Security\",\n \"sub_classification\": \"Host\",\n \"resource_type\": \"Virtual_Machines\",\n \"service_resource\": [\n \"Virtual_Machines\"\n ],\n \"severity\": \"high\",\n \"uri\": \"policy/azure_policy/global/azure/compliance/others/ccc81\"\n },\n \"policyRule\": {\n \"if\": {\n \"anyOf\": [\n {\n \"allOf\": [\n {\n \"field\": \"type\",\n \"equals\": \"Microsoft.Compute/virtualMachines\"\n },\n {\n \"anyOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"in\": [\n \"microsoft-aks\",\n \"qubole-inc\",\n \"datastax\",\n \"couchbase\",\n \"scalegrid\",\n \"checkpoint\",\n \"paloaltonetworks\",\n \"debian\"\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"OpenLogic\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"like\": \"CentOS*\"\n },\n {\n \"field\": \"Microsoft.Compute/imageSKU\",\n \"notLike\": \"6*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"Oracle\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"equals\": \"Oracle-Linux\"\n },\n {\n \"field\": \"Microsoft.Compute/imageSKU\",\n \"notLike\": \"6*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"RedHat\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"in\": [\n \"RHEL\",\n \"RHEL-HA\",\n \"RHEL-SAP\",\n \"RHEL-SAP-APPS\",\n \"RHEL-SAP-HA\",\n \"RHEL-SAP-HANA\"\n ]\n },\n {\n \"field\": \"Microsoft.Compute/imageSKU\",\n \"notLike\": \"6*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"RedHat\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"in\": [\n \"osa\",\n \"rhel-byos\"\n ]\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"center-for-internet-security-inc\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"in\": [\n \"cis-centos-7-l1\",\n \"cis-centos-7-v2-1-1-l1\",\n \"cis-centos-8-l1\",\n \"cis-debian-linux-8-l1\",\n \"cis-debian-linux-9-l1\",\n \"cis-nginx-centos-7-v1-1-0-l1\",\n \"cis-oracle-linux-7-v2-0-0-l1\",\n \"cis-oracle-linux-8-l1\",\n \"cis-postgresql-11-centos-linux-7-level-1\",\n \"cis-rhel-7-l2\",\n \"cis-rhel-7-v2-2-0-l1\",\n \"cis-rhel-8-l1\",\n \"cis-suse-linux-12-v2-0-0-l1\",\n \"cis-ubuntu-linux-1604-v1-0-0-l1\",\n \"cis-ubuntu-linux-1804-l1\"\n ]\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"credativ\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"equals\": \"Debian\"\n },\n {\n \"field\": \"Microsoft.Compute/imageSKU\",\n \"notLike\": \"7*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"Suse\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"like\": \"SLES*\"\n },\n {\n \"field\": \"Microsoft.Compute/imageSKU\",\n \"notLike\": \"11*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"Canonical\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"equals\": \"UbuntuServer\"\n },\n {\n \"field\": \"Microsoft.Compute/imageSKU\",\n \"notLike\": \"12*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"microsoft-dsvm\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"in\": [\n \"linux-data-science-vm-ubuntu\",\n \"azureml\"\n ]\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"cloudera\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"equals\": \"cloudera-centos-os\"\n },\n {\n \"field\": \"Microsoft.Compute/imageSKU\",\n \"notLike\": \"6*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"cloudera\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"equals\": \"cloudera-altus-centos-os\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"equals\": \"microsoft-ads\"\n },\n {\n \"field\": \"Microsoft.Compute/imageOffer\",\n \"like\": \"linux*\"\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"anyOf\": [\n {\n \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\n \"exists\": \"true\"\n },\n {\n \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\n \"like\": \"Linux*\"\n }\n ]\n },\n {\n \"anyOf\": [\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"exists\": \"false\"\n },\n {\n \"field\": \"Microsoft.Compute/imagePublisher\",\n \"notIn\": [\n \"OpenLogic\",\n \"RedHat\",\n \"credativ\",\n \"Suse\",\n \"Canonical\",\n \"microsoft-dsvm\",\n \"cloudera\",\n \"microsoft-ads\",\n \"center-for-internet-security-inc\",\n \"Oracle\"\n ]\n }\n ]\n }\n ]\n }\n ]\n }\n ]\n },\n {\n \"allOf\": [\n {\n \"field\": \"type\",\n \"equals\": \"Microsoft.HybridCompute/machines\"\n },\n {\n \"field\": \"Microsoft.HybridCompute/imageOffer\",\n \"like\": \"linux*\"\n }\n ]\n }\n ]\n },\n \"then\": {\n \"effect\": \"auditIfNotExists\",\n \"details\": {\n \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\n \"name\": \"PasswordPolicy_msid121\",\n \"existenceCondition\": {\n \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\n \"equals\": \"Compliant\"\n }\n }\n }\n }\n}\n",
  "parameters": {},
  "classification": "Security",
  "sub_classification": "Host",
  "service_resource": [
    "Virtual_Machines"
  ],
  "resource_type": "Virtual_Machines",
  "severity": "high",
  "type": [
    "Cloud"
  ],
  "services": [
    "Azure"
  ],
  "scope": "global",
  "metadata": {},
  "resources": [],
  "is_temp": false,
  "is_system_policy": false,
  "recommendation": {
    "name": "Azure_Audit_LinuxVM_PasswdFile_Permission",
    "description": "This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that do not have the passwd file permissions set to 0644",
    "actions": []
  },
  "uri": "policy/azure_policy/global/azure/compliance/others/ccc81"
}
