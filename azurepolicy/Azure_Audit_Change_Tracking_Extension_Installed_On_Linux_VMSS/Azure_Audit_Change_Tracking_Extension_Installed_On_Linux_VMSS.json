{
  "name": "Azure_Audit_Change_Tracking_Extension_Installed_On_Linux_VMSS",
  "policy_id": "/providers/Microsoft.Authorization/policyDefinitions/e71c1e29-9c76-4532-8c4b-cb0573b0014c",
  "display_name": "Azure Audit Change Tracking Extension Installed On Linux VMSS",
  "description": "Install ChangeTracking Extension on Linux virtual machine scale sets to enable File Integrity Monitoring(FIM) in Azure Security Center. FIM examines operating system files, Windows registries, application software, Linux system files, and more, for changes that might indicate an attack. The extension can be installed in virtual machines and locations supported by Azure Monitoring Agent.",
  "category": "service",
  "status": "active",
  "content": "{\r\n      \"displayName\": \"[Preview]: ChangeTracking extension should be installed on your Linux virtual machine scale sets\",\r\n      \"policyType\": \"BuiltIn\",\r\n      \"mode\": \"Indexed\",\r\n      \"description\": \"Install ChangeTracking Extension on Linux virtual machine scale sets to enable File Integrity Monitoring(FIM) in Azure Security Center. FIM examines operating system files, Windows registries, application software, Linux system files, and more, for changes that might indicate an attack. The extension can be installed in virtual machines and locations supported by Azure Monitoring Agent.\",\r\n      \"metadata\": {\r\n        \"version\": \"1.0.0-preview\",\r\n        \"category\": \"Security Center\",\r\n        \"policy_id\": \"/providers/Microsoft.Authorization/policyDefinitions/e71c1e29-9c76-4532-8c4b-cb0573b0014c\"\r\n      },\r\n      \"parameters\": {\r\n        \"effect\": {\r\n          \"type\": \"String\",\r\n          \"metadata\": {\r\n            \"displayName\": \"Effect\",\r\n            \"description\": \"Enable or disable the execution of the policy\"\r\n          },\r\n          \"allowedValues\": [\r\n            \"AuditIfNotExists\",\r\n            \"Disabled\"\r\n          ],\r\n          \"defaultValue\": \"AuditIfNotExists\"\r\n        },\r\n        \"listOfApplicableLocations\": {\r\n          \"type\": \"Array\",\r\n          \"metadata\": {\r\n            \"displayName\": \"Applicable Locations\",\r\n            \"description\": \"The list of locations where the policy should be applied.\",\r\n            \"strongType\": \"location\"\r\n          },\r\n          \"allowedValues\": [\r\n            \"australiasoutheast\",\r\n            \"australiaeast\",\r\n            \"brazilsouth\",\r\n            \"canadacentral\",\r\n            \"centralindia\",\r\n            \"centralus\",\r\n            \"eastasia\",\r\n            \"eastus2euap\",\r\n            \"eastus\",\r\n            \"eastus2\",\r\n            \"francecentral\",\r\n            \"japaneast\",\r\n            \"koreacentral\",\r\n            \"northcentralus\",\r\n            \"northeurope\",\r\n            \"norwayeast\",\r\n            \"southcentralus\",\r\n            \"southeastasia\",\r\n            \"switzerlandnorth\",\r\n            \"uaenorth\",\r\n            \"uksouth\",\r\n            \"westcentralus\",\r\n            \"westeurope\",\r\n            \"westus\",\r\n            \"westus2\"\r\n          ],\r\n          \"defaultValue\": [\r\n            \"australiasoutheast\",\r\n            \"australiaeast\",\r\n            \"brazilsouth\",\r\n            \"canadacentral\",\r\n            \"centralindia\",\r\n            \"centralus\",\r\n            \"eastasia\",\r\n            \"eastus2euap\",\r\n            \"eastus\",\r\n            \"eastus2\",\r\n            \"francecentral\",\r\n            \"japaneast\",\r\n            \"koreacentral\",\r\n            \"northcentralus\",\r\n            \"northeurope\",\r\n            \"norwayeast\",\r\n            \"southcentralus\",\r\n            \"southeastasia\",\r\n            \"switzerlandnorth\",\r\n            \"uaenorth\",\r\n            \"uksouth\",\r\n            \"westcentralus\",\r\n            \"westeurope\",\r\n            \"westus\",\r\n            \"westus2\"\r\n          ]\r\n        }\r\n      },\r\n      \"policyRule\": {\r\n        \"if\": {\r\n          \"allOf\": [\r\n            {\r\n              \"field\": \"type\",\r\n              \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n            },\r\n            {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('listOfApplicableLocations')]\"\r\n            },\r\n            {\r\n              \"anyOf\": [\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"RedHat\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"RHEL\",\r\n                        \"RHEL-SAP-HANA\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"8*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"SUSE\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"SLES\",\r\n                        \"SLES-HPC\",\r\n                        \"SLES-HPC-Priority\",\r\n                        \"SLES-SAP\",\r\n                        \"SLES-SAP-BYOS\",\r\n                        \"SLES-Priority\",\r\n                        \"SLES-BYOS\",\r\n                        \"SLES-SAPCAL\",\r\n                        \"SLES-Standard\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"15*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Canonical\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"UbuntuServer\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"14.04*LTS\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"16.04*LTS\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"18.04*LTS\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Canonical\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"0001-com-ubuntu-server-focal\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"20_04-lts*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Oracle\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"Oracle-Linux\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"8*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"OpenLogic\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"CentOS\",\r\n                        \"Centos-LVM\",\r\n                        \"CentOS-SRIOV\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"8*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"cloudera\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"cloudera-centos-os\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSKU\",\r\n                      \"like\": \"7*\"\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"credativ\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"debian\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"8\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"9\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Debian\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"debian-10\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSKU\",\r\n                      \"like\": \"10\"\r\n                    }\r\n                  ]\r\n                }\r\n              ]\r\n            }\r\n          ]\r\n        },\r\n        \"then\": {\r\n          \"effect\": \"[parameters('effect')]\",\r\n          \"details\": {\r\n            \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n            \"existenceCondition\": {\r\n              \"allOf\": [\r\n                {\r\n                  \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                  \"equals\": \"ChangeTracking-Linux\"\r\n                },\r\n                {\r\n                  \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                  \"equals\": \"Microsoft.Azure.ChangeTrackingAndInventory\"\r\n                },\r\n                {\r\n                  \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/provisioningState\",\r\n                  \"equals\": \"Succeeded\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      }\r\n  }",
  "parameters": {},
  "classification": "Security",
  "sub_classification": "Application",
  "service_resource": [
    "Subscription"
  ],
  "resource_type": "Subscription",
  "severity": "high",
  "type": [
    "Cloud"
  ],
  "services": [
    "Azure"
  ],
  "scope": "global",
  "metadata": {},
  "resources": [],
  "is_temp": false,
  "is_system_policy": false,
  "recommendation": {
    "name": "Azure_Audit_Change_Tracking_Extension_Installed_On_Linux_VMSS",
    "description": "Install ChangeTracking Extension on Linux virtual machine scale sets to enable File Integrity Monitoring(FIM) in Azure Security Center. FIM examines operating system files, Windows registries, application software, Linux system files, and more, for changes that might indicate an attack. The extension can be installed in virtual machines and locations supported by Azure Monitoring Agent.",
    "actions": []
  },
    "uri": "policy/azure_policy/global/azure/compliance/others/mqptk"
}
